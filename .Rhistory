labels = c("DEC","NOV","OCT","SEP","AUG"))
HSKP$Hotel <- paste(HSKP$Hotel,HSKP$Hotel_Description,sep=" ")
view(HSKP_Report)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(scales)
library(glue)
library(extrafont)
loadfonts(device = "win")
options(dplyr.summarise.inform = FALSE)
Hotel_Revenue <-read.csv2("Hotels_Revenue.csv",sep=";")
Rooms_SQM2 <-read.csv2("Rooms_sq.m..csv",sep=";",)
HSKP <- merge(Hotel_Revenue,Rooms_SQM2,by.x = c('ï..Hotel','Category'),by.y = c('ï..Hotel','Category'))
HSKP$Days_in_Month <- as.numeric(as.character(HSKP$Days_in_Month))
HSKP$Hotel_Invetory <- as.numeric(as.character(HSKP$Hotel_Invetory))
HSKP$Total_Rooms <- as.numeric(as.character(HSKP$Total_Rooms))
HSKP$Mediana <- as.numeric(as.character(HSKP$Mediana))
HSKP$Fixed_Occ. <- as.numeric(as.character(HSKP$Fixed_Occ.))
HSKP$Conf_of_Occ._per_Category <- as.numeric(as.character(HSKP$Conf_of_Occ._per_Category))
names(HSKP)[10]<-'SQM'
names(HSKP)[1]<-'Hotel'
HSKP$Rooms_Sold <- round(HSKP[,6]*HSKP[,7]*HSKP[,5]*HSKP[,8],)
HSKP$Rooms_Avaliable <- HSKP[,5]*HSKP[,7]
HSKP$Category_Occ <- HSKP[,11]/HSKP[,12]
HSKP$Sum_SQM <- HSKP[,11]*HSKP[,10]
HSKP$SQM_per_day <- HSKP[,14]/HSKP[,5]
#NORM
HSKP$Cleaning_Hours_per_day <- HSKP[,15]*40/min(HSKP$SQM)/60
HSKP$FTE <-ceiling(HSKP[,16]/8)
#Transpose Months
HSKP_final <- pivot_wider(HSKP,names_from = Month,
values_from = FTE)
#Summary table
HSKP_Report <-HSKP_final %>%
group_by (Hotel,Hotel_Description) %>%
summarize (sum(August,na.rm = TRUE),sum(September,na.rm = TRUE),sum(October,na.rm = TRUE),
sum(November,na.rm = TRUE),sum(December,na.rm = TRUE))
names(HSKP_Report)[3]<-'August'
names(HSKP_Report)[4]<-'September'
names(HSKP_Report)[5]<-'October'
names(HSKP_Report)[6]<-'November'
names(HSKP_Report)[7]<-'December'
#HSKP_Report is standard presentation table
HSKP_Report [nrow(HSKP_Report)+1,] <- list("","Total",sum (HSKP_Report$August),sum(HSKP_Report$September),                                sum(HSKP_Report$October),sum(HSKP_Report$November),sum(HSKP_Report$December))
#Rename and re-order the factor levels before the plot
HSKP$Month <-factor(HSKP$Month,levels = c("December","November","October","September","August"),
labels = c("DEC","NOV","OCT","SEP","AUG"))
HSKP$Hotel <- paste(HSKP$Hotel,HSKP$Hotel_Description,sep=" ")
kable(HSKP_Report)
install.packages("knitr")
install.packages("knitr")
install.packages("knitr")
install.packages("knitr")
library(tidyverse)
library(dplyr)
options(dplyr.summarise.inform = FALSE)
library(ggplot2)
library(scales)
library(glue)
library(extrafont)
loadfonts(device = "win")
library(knitr)
library(tidyverse)
library(dplyr)
options(dplyr.summarise.inform = FALSE)
library(ggplot2)
library(scales)
library(glue)
library(extrafont)
loadfonts(device = "win")
library(knitr)
Hotel_Revenue <-read.csv2("Hotels_Revenue.csv",sep=";")
Rooms_SQM2 <-read.csv2("Rooms_sq.m..csv",sep=";",)
HSKP <- merge(Hotel_Revenue,Rooms_SQM2,by.x = c('ï..Hotel','Category'),by.y = c('ï..Hotel','Category'))
HSKP$Days_in_Month <- as.numeric(as.character(HSKP$Days_in_Month))
HSKP$Hotel_Invetory <- as.numeric(as.character(HSKP$Hotel_Invetory))
HSKP$Total_Rooms <- as.numeric(as.character(HSKP$Total_Rooms))
HSKP$Mediana <- as.numeric(as.character(HSKP$Mediana))
HSKP$Fixed_Occ. <- as.numeric(as.character(HSKP$Fixed_Occ.))
HSKP$Conf_of_Occ._per_Category <- as.numeric(as.character(HSKP$Conf_of_Occ._per_Category))
names(HSKP)[10]<-'SQM'
names(HSKP)[1]<-'Hotel'
HSKP$Rooms_Sold <- round(HSKP[,6]*HSKP[,7]*HSKP[,5]*HSKP[,8],)
HSKP$Rooms_Avaliable <- HSKP[,5]*HSKP[,7]
HSKP$Category_Occ <- HSKP[,11]/HSKP[,12]
HSKP$Sum_SQM <- HSKP[,11]*HSKP[,10]
HSKP$SQM_per_day <- HSKP[,14]/HSKP[,5]
#NORM
HSKP$Cleaning_Hours_per_day <- HSKP[,15]*40/min(HSKP$SQM)/60
HSKP$FTE <-ceiling(HSKP[,16]/8)
#Transpose Months
HSKP_final <- pivot_wider(HSKP,names_from = Month,
values_from = FTE)
#Summary table
HSKP_Report <-HSKP_final %>%
group_by (Hotel,Hotel_Description) %>%
summarize (sum(August,na.rm = TRUE),sum(September,na.rm = TRUE),sum(October,na.rm = TRUE),
sum(November,na.rm = TRUE),sum(December,na.rm = TRUE))
names(HSKP_Report)[3]<-'August'
names(HSKP_Report)[4]<-'September'
names(HSKP_Report)[5]<-'October'
names(HSKP_Report)[6]<-'November'
names(HSKP_Report)[7]<-'December'
#HSKP_Report is standard presentation table
HSKP_Report [nrow(HSKP_Report)+1,] <- list("","Total",sum (HSKP_Report$August),sum(HSKP_Report$September),                                sum(HSKP_Report$October),sum(HSKP_Report$November),sum(HSKP_Report$December))
#Rename and re-order the factor levels before the plot
HSKP$Month <-factor(HSKP$Month,levels = c("December","November","October","September","August"),
labels = c("DEC","NOV","OCT","SEP","AUG"))
HSKP$Hotel <- paste(HSKP$Hotel,HSKP$Hotel_Description,sep=" ")
kable(HSKP_Report)
summary(cars)
plot(pressure)
HSKP %>%
ggplot()+
geom_col (aes(x=FTE,y=Month,fill=Hotel),
show.legend = FALSE)+
geom_jitter(aes(x=FTE,y=Month),
color = 'black',
stat = 'identity',
show.legend = FALSE,
position=position_jitter(seed=1),
)+
facet_wrap(~Hotel)+
labs(title = "ROOM CLEANING STUFF ANALYSIS",
x=NULL,
y=NULL)+
theme_minimal()+
theme(text = element_text(family = 'serif'),
strip.text = element_text(face = 'bold',hjust = 0.25),
panel.grid.major = element_line('white',size=0.5),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE)+
scale_x_continuous(limits = c(0,40), breaks = seq(0,40,by=5))
Hotel_Revenue <-read.csv2("Hotels_Revenue.csv",sep=";")
Rooms_SQM2 <-read.csv2("Rooms_sq.m..csv",sep=";",)
HSKP <- merge(Hotel_Revenue,Rooms_SQM2,by.x = c('ï..Hotel','Category'),by.y = c('ï..Hotel','Category'))
HSKP$Days_in_Month <- as.numeric(as.character(HSKP$Days_in_Month))
HSKP$Hotel_Invetory <- as.numeric(as.character(HSKP$Hotel_Invetory))
HSKP$Total_Rooms <- as.numeric(as.character(HSKP$Total_Rooms))
HSKP$Mediana <- as.numeric(as.character(HSKP$Mediana))
HSKP$Fixed_Occ. <- as.numeric(as.character(HSKP$Fixed_Occ.))
HSKP$Conf_of_Occ._per_Category <- as.numeric(as.character(HSKP$Conf_of_Occ._per_Category))
names(HSKP)[10]<-'SQM'
names(HSKP)[1]<-'Hotel'
HSKP$Rooms_Sold <- round(HSKP[,6]*HSKP[,7]*HSKP[,5]*HSKP[,8],)
HSKP$Rooms_Avaliable <- HSKP[,5]*HSKP[,7]
HSKP$Category_Occ <- HSKP[,11]/HSKP[,12]
HSKP$Sum_SQM <- HSKP[,11]*HSKP[,10]
HSKP$SQM_per_day <- HSKP[,14]/HSKP[,5]
#NORM
HSKP$Cleaning_Hours_per_day <- HSKP[,15]*40/min(HSKP$SQM)/60
HSKP$FTE <-ceiling(HSKP[,16]/8)
#Transpose Months
HSKP_final <- pivot_wider(HSKP,names_from = Month,
values_from = FTE)
#Summary table
HSKP_Report <-HSKP_final %>%
group_by (Hotel,Hotel_Description) %>%
summarize (sum(August,na.rm = TRUE),sum(September,na.rm = TRUE),sum(October,na.rm = TRUE),
sum(November,na.rm = TRUE),sum(December,na.rm = TRUE))
names(HSKP_Report)[3]<-'August'
names(HSKP_Report)[4]<-'September'
names(HSKP_Report)[5]<-'October'
names(HSKP_Report)[6]<-'November'
names(HSKP_Report)[7]<-'December'
#HSKP_Report is standard presentation table
HSKP_Report [nrow(HSKP_Report)+1,] <- list("","Total",sum (HSKP_Report$August),sum(HSKP_Report$September),                                sum(HSKP_Report$October),sum(HSKP_Report$November),sum(HSKP_Report$December))
#Rename and re-order the factor levels before the plot
HSKP$Month <-factor(HSKP$Month,levels = c("December","November","October","September","August"),
labels = c("DEC","NOV","OCT","SEP","AUG"))
HSKP$Hotel <- paste(HSKP$Hotel,HSKP$Hotel_Description,sep=" ")
kable(HSKP_Report)
install.packages("tidyverse")
install.packages("dplyr")
install.packages("ggplot2")
install.packages("scales")
install.packages("glue")
install.packages("extrafont")
install.packages("knitr")
library(tidyverse)
library(dplyr)
options(dplyr.summarise.inform = FALSE)
library(ggplot2)
library(scales)
library(glue)
library(extrafont)
loadfonts(device = "win")
library(knitr)
Hotel_Revenue <-read.csv2("Hotels_Revenue.csv",sep=";")
Rooms_SQM2 <-read.csv2("Rooms_sq.m..csv",sep=";",)
HSKP <- merge(Hotel_Revenue,Rooms_SQM2,by.x = c('ï..Hotel','Category'),by.y = c('ï..Hotel','Category'))
HSKP$Days_in_Month <- as.numeric(as.character(HSKP$Days_in_Month))
HSKP$Hotel_Invetory <- as.numeric(as.character(HSKP$Hotel_Invetory))
HSKP$Total_Rooms <- as.numeric(as.character(HSKP$Total_Rooms))
HSKP$Mediana <- as.numeric(as.character(HSKP$Mediana))
HSKP$Fixed_Occ. <- as.numeric(as.character(HSKP$Fixed_Occ.))
HSKP$Conf_of_Occ._per_Category <- as.numeric(as.character(HSKP$Conf_of_Occ._per_Category))
names(HSKP)[10]<-'SQM'
names(HSKP)[1]<-'Hotel'
HSKP$Rooms_Sold <- round(HSKP[,6]*HSKP[,7]*HSKP[,5]*HSKP[,8],)
HSKP$Rooms_Avaliable <- HSKP[,5]*HSKP[,7]
HSKP$Category_Occ <- HSKP[,11]/HSKP[,12]
HSKP$Sum_SQM <- HSKP[,11]*HSKP[,10]
HSKP$SQM_per_day <- HSKP[,14]/HSKP[,5]
#NORM
HSKP$Cleaning_Hours_per_day <- HSKP[,15]*40/min(HSKP$SQM)/60
HSKP$FTE <-ceiling(HSKP[,16]/8)
#Transpose Months
HSKP_final <- pivot_wider(HSKP,names_from = Month,
values_from = FTE)
#Summary table
HSKP_Report <-HSKP_final %>%
group_by (Hotel,Hotel_Description) %>%
summarize (sum(August,na.rm = TRUE),sum(September,na.rm = TRUE),sum(October,na.rm = TRUE),
sum(November,na.rm = TRUE),sum(December,na.rm = TRUE))
names(HSKP_Report)[3]<-'August'
names(HSKP_Report)[4]<-'September'
names(HSKP_Report)[5]<-'October'
names(HSKP_Report)[6]<-'November'
names(HSKP_Report)[7]<-'December'
#HSKP_Report is standard presentation table
HSKP_Report [nrow(HSKP_Report)+1,] <- list("","Total",sum (HSKP_Report$August),sum(HSKP_Report$September),                                sum(HSKP_Report$October),sum(HSKP_Report$November),sum(HSKP_Report$December))
#Rename and re-order the factor levels before the plot
HSKP$Month <-factor(HSKP$Month,levels = c("December","November","October","September","August"),
labels = c("DEC","NOV","OCT","SEP","AUG"))
HSKP$Hotel <- paste(HSKP$Hotel,HSKP$Hotel_Description,sep=" ")
kable(HSKP_Report)
HSKP %>%
ggplot()+
geom_col (aes(x=FTE,y=Month,fill=Hotel),
show.legend = FALSE)+
geom_jitter(aes(x=FTE,y=Month),
color = 'black',
stat = 'identity',
show.legend = FALSE,
position=position_jitter(seed=1),
)+
facet_wrap(~Hotel)+
labs(title = "ROOM CLEANING STUFF ANALYSIS",
x=NULL,
y=NULL)+
theme_minimal()+
theme(text = element_text(family = 'serif'),
strip.text = element_text(face = 'bold',hjust = 0.25),
panel.grid.major = element_line('white',size=0.5),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE)+
scale_x_continuous(limits = c(0,40), breaks = seq(0,40,by=5))
install.packages("knitr")
library(tidyverse)
library(dplyr)
options(dplyr.summarise.inform = FALSE)
library(ggplot2)
library(scales)
library(glue)
library(extrafont)
loadfonts(device = "win")
library(knitr)
Hotel_Revenue <-read.csv2("Hotels_Revenue.csv",sep=";")
Rooms_SQM2 <-read.csv2("Rooms_sq.m..csv",sep=";",)
HSKP <- merge(Hotel_Revenue,Rooms_SQM2,by.x = c('ï..Hotel','Category'),by.y = c('ï..Hotel','Category'))
HSKP$Days_in_Month <- as.numeric(as.character(HSKP$Days_in_Month))
HSKP$Hotel_Invetory <- as.numeric(as.character(HSKP$Hotel_Invetory))
HSKP$Total_Rooms <- as.numeric(as.character(HSKP$Total_Rooms))
HSKP$Mediana <- as.numeric(as.character(HSKP$Mediana))
HSKP$Fixed_Occ. <- as.numeric(as.character(HSKP$Fixed_Occ.))
HSKP$Conf_of_Occ._per_Category <- as.numeric(as.character(HSKP$Conf_of_Occ._per_Category))
names(HSKP)[10]<-'SQM'
names(HSKP)[1]<-'Hotel'
HSKP$Rooms_Sold <- round(HSKP[,6]*HSKP[,7]*HSKP[,5]*HSKP[,8],)
HSKP$Rooms_Avaliable <- HSKP[,5]*HSKP[,7]
HSKP$Category_Occ <- HSKP[,11]/HSKP[,12]
HSKP$Sum_SQM <- HSKP[,11]*HSKP[,10]
HSKP$SQM_per_day <- HSKP[,14]/HSKP[,5]
#NORM
HSKP$Cleaning_Hours_per_day <- HSKP[,15]*40/min(HSKP$SQM)/60
HSKP$FTE <-ceiling(HSKP[,16]/8)
#Transpose Months
HSKP_final <- pivot_wider(HSKP,names_from = Month,
values_from = FTE)
#Summary table
HSKP_Report <-HSKP_final %>%
group_by (Hotel,Hotel_Description) %>%
summarize (sum(August,na.rm = TRUE),sum(September,na.rm = TRUE),sum(October,na.rm = TRUE),
sum(November,na.rm = TRUE),sum(December,na.rm = TRUE))
names(HSKP_Report)[3]<-'August'
names(HSKP_Report)[4]<-'September'
names(HSKP_Report)[5]<-'October'
names(HSKP_Report)[6]<-'November'
names(HSKP_Report)[7]<-'December'
#HSKP_Report is standard presentation table
HSKP_Report [nrow(HSKP_Report)+1,] <- list("","Total",sum (HSKP_Report$August),sum(HSKP_Report$September),                                sum(HSKP_Report$October),sum(HSKP_Report$November),sum(HSKP_Report$December))
#Rename and re-order the factor levels before the plot
HSKP$Month <-factor(HSKP$Month,levels = c("December","November","October","September","August"),
labels = c("DEC","NOV","OCT","SEP","AUG"))
HSKP$Hotel <- paste(HSKP$Hotel,HSKP$Hotel_Description,sep=" ")
kable(HSKP_Report)
HSKP %>%
ggplot()+
geom_col (aes(x=FTE,y=Month,fill=Hotel),
show.legend = FALSE)+
geom_jitter(aes(x=FTE,y=Month),
color = 'black',
stat = 'identity',
show.legend = FALSE,
position=position_jitter(seed=1),
)+
facet_wrap(~Hotel)+
labs(title = "ROOM CLEANING STUFF ANALYSIS",
x=NULL,
y=NULL)+
theme_minimal()+
theme(text = element_text(family = 'serif'),
strip.text = element_text(face = 'bold',hjust = 0.25),
panel.grid.major = element_line('white',size=0.5),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE)+
scale_x_continuous(limits = c(0,40), breaks = seq(0,40,by=5))
install.packages("knitr")
install.packages("knitr")
Hotel_Revenue <-read.csv2("Hotels_Revenue.csv",sep=";")
Rooms_SQM2 <-read.csv2("Rooms_sq.m..csv",sep=";",)
HSKP <- merge(Hotel_Revenue,Rooms_SQM2,by.x = c('ï..Hotel','Category'),by.y = c('ï..Hotel','Category'))
HSKP$Days_in_Month <- as.numeric(as.character(HSKP$Days_in_Month))
HSKP$Hotel_Invetory <- as.numeric(as.character(HSKP$Hotel_Invetory))
HSKP$Total_Rooms <- as.numeric(as.character(HSKP$Total_Rooms))
HSKP$Mediana <- as.numeric(as.character(HSKP$Mediana))
HSKP$Fixed_Occ. <- as.numeric(as.character(HSKP$Fixed_Occ.))
HSKP$Conf_of_Occ._per_Category <- as.numeric(as.character(HSKP$Conf_of_Occ._per_Category))
names(HSKP)[10]<-'SQM'
names(HSKP)[1]<-'Hotel'
HSKP$Rooms_Sold <- round(HSKP[,6]*HSKP[,7]*HSKP[,5]*HSKP[,8],)
HSKP$Rooms_Avaliable <- HSKP[,5]*HSKP[,7]
HSKP$Category_Occ <- HSKP[,11]/HSKP[,12]
HSKP$Sum_SQM <- HSKP[,11]*HSKP[,10]
HSKP$SQM_per_day <- HSKP[,14]/HSKP[,5]
Hotel_Revenue <-read.csv2("Hotels_Revenue.csv",sep=";")
Rooms_SQM2 <-read.csv2("Rooms_sq.m..csv",sep=";",)
HSKP <- merge(Hotel_Revenue,Rooms_SQM2,by.x = c('ï..Hotel','Category'),by.y = c('ï..Hotel','Category'))
HSKP$Days_in_Month <- as.numeric(as.character(HSKP$Days_in_Month))
HSKP$Hotel_Invetory <- as.numeric(as.character(HSKP$Hotel_Invetory))
HSKP$Total_Rooms <- as.numeric(as.character(HSKP$Total_Rooms))
HSKP$Mediana <- as.numeric(as.character(HSKP$Mediana))
HSKP$Fixed_Occ. <- as.numeric(as.character(HSKP$Fixed_Occ.))
HSKP$Conf_of_Occ._per_Category <- as.numeric(as.character(HSKP$Conf_of_Occ._per_Category))
names(HSKP)[10]<-'SQM'
names(HSKP)[1]<-'Hotel'
HSKP$Rooms_Sold <- round(HSKP[,6]*HSKP[,7]*HSKP[,5]*HSKP[,8],)
HSKP$Rooms_Avaliable <- HSKP[,5]*HSKP[,7]
HSKP$Category_Occ <- HSKP[,11]/HSKP[,12]
HSKP$Sum_SQM <- HSKP[,11]*HSKP[,10]
HSKP$SQM_per_day <- HSKP[,14]/HSKP[,5]
#NORM
HSKP$Cleaning_Hours_per_day <- HSKP[,15]*40/min(HSKP$SQM)/60
HSKP$FTE <-ceiling(HSKP[,16]/8)
#Transpose Months
HSKP_final <- pivot_wider(HSKP,names_from = Month,
values_from = FTE)
library(tidyverse)
library(dplyr)
options(dplyr.summarise.inform = FALSE)
library(ggplot2)
library(scales)
library(glue)
library(extrafont)
loadfonts(device = "win")
library (knitr)
Av_HSKP_FTE <- function (x){Mean <- mean (HSKP_Report$Report, na.rm=TRUE)}
av_HSKP_FTE
```{r}
Mean <-row.summary (HSKP_Report)
Meanx <- row.summary (HSKP_Report)
xzc <- row.summary (HSKP_Report)
?row.summary
view (HSKP_final)
view(HSKP_final)
kable(HSKP_final)
Summary (HSKP_Report)
Summary (HSKP_Report [nrow(HSKP_Report),])
HSKP_Report [nrow(HSKP_Report)-1,] <- list()
head(HSKP_Report,-1)
head(HSKP_Report,-1)
c <- head(HSKP_Report,0)
Last_row <- tail(HSKP_Report, n = 1)
?tail
tail(HSKP_Report,1)
view(F_Results)
view(F_Result)
print("Hello World!", quote = FALSE)
print("R", quote = FALSE)
library(glue)
#####
install.packages("tidyverse")
install.packages("dplyr")
install.packages("ggplot2")
install.packages("scales")
install.packages("glue")
install.packages("extrafont")
library(tidyverse)
library(dplyr)
library(ggplot2)
library(scales)
library(glue)
library(extrafont)
loadfonts(device = "win")
#####
#####
setwd ("C:/Users/E-MaxPCShop/Desktop/R_Project/Calc_HSKP_Project")
Hotel_Revenue <-read.csv2("Hotels_Revenue.csv",sep=";")
Rooms_SQM2 <-read.csv2("Rooms_sq.m..csv",sep=";",)
HSKP <- merge(Hotel_Revenue,Rooms_SQM2,by.x = c('ï..Hotel','Category'),by.y = c('ï..Hotel','Category'))
HSKP$Days_in_Month <- as.numeric(as.character(HSKP$Days_in_Month))
HSKP$Hotel_Invetory <- as.numeric(as.character(HSKP$Hotel_Invetory))
HSKP$Total_Rooms <- as.numeric(as.character(HSKP$Total_Rooms))
HSKP$Mediana <- as.numeric(as.character(HSKP$Mediana))
HSKP$Fixed_Occ. <- as.numeric(as.character(HSKP$Fixed_Occ.))
HSKP$Conf_of_Occ._per_Category <- as.numeric(as.character(HSKP$Conf_of_Occ._per_Category))
names(HSKP)[10]<-'SQM'
names(HSKP)[1]<-'Hotel'
HSKP$Rooms_Sold <- round(HSKP[,6]*HSKP[,7]*HSKP[,5]*HSKP[,8],)
HSKP$Rooms_Avaliable <- HSKP[,5]*HSKP[,7]
HSKP$Category_Occ <- HSKP[,11]/HSKP[,12]
HSKP$Sum_SQM <- HSKP[,11]*HSKP[,10]
HSKP$SQM_per_day <- HSKP[,14]/HSKP[,5]
#NORM
HSKP$Cleaning_Hours_per_day <- HSKP[,15]*40/min(HSKP$SQM)/60
HSKP$FTE <-ceiling(HSKP[,16]/8)
#Transpose Months
HSKP_final <- pivot_wider(HSKP,names_from = Month,
values_from = FTE)
#Summary table
HSKP_Report <-HSKP_final %>%
group_by (Hotel,Hotel_Description) %>%
summarize (sum(August,na.rm = TRUE),sum(September,na.rm = TRUE),sum(October,na.rm = TRUE),
sum(November,na.rm = TRUE),sum(December,na.rm = TRUE))
names(HSKP_Report)[3]<-'August'
names(HSKP_Report)[4]<-'September'
names(HSKP_Report)[5]<-'October'
names(HSKP_Report)[6]<-'November'
names(HSKP_Report)[7]<-'December'
#HSKP_Report is standard presentation table
HSKP_Report [nrow(HSKP_Report)+1,] <- list("","Total",sum (HSKP_Report$August),sum(HSKP_Report$September),
sum(HSKP_Report$October),sum(HSKP_Report$November),sum(HSKP_Report$December))
#Rename and re-order the factor levels before the plot
HSKP$Month <-factor(HSKP$Month,levels = c("December","November","October","September","August"),
labels = c("DEC","NOV","OCT","SEP","AUG"))
HSKP$Hotel <- paste(HSKP$Hotel,HSKP$Hotel_Description,sep=" ")
HSKP %>%
ggplot()+
geom_col (aes(x=FTE,y=Month,fill=Hotel),
show.legend = FALSE)+
geom_jitter(aes(x=FTE,y=Month),
color = 'black',
stat = 'identity',
show.legend = FALSE,
position=position_jitter(seed=1),
)+
facet_wrap(~Hotel)+
labs(title = "ROOM CLEANING STUFF ANALYSIS",
x=NULL,
y=NULL)+
theme_minimal()+
theme(text = element_text(family = 'serif'),
strip.text = element_text(face = 'bold',hjust = 0.25),
panel.grid.major = element_line('white',size=0.5),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
panel.ontop = TRUE)+
scale_x_continuous(limits = c(0,40), breaks = seq(0,40,by=5))
install.packages("glue")
View(HSKP)
View(HSKP)
setwd ("C:/Users/E-MaxPCShop/Desktop/R_Project/Calc_HSKP_Project")
Hotel_Revenue <-read.csv2("Hotels_Revenue.csv",sep=";")
Rooms_SQM2 <-read.csv2("Rooms_sq.m..csv",sep=";",)
HSKP <- merge(Hotel_Revenue,Rooms_SQM2,by.x = c('ï..Hotel','Category'),by.y = c('ï..Hotel','Category'))
HSKP$Days_in_Month <- as.numeric(as.character(HSKP$Days_in_Month))
HSKP$Hotel_Invetory <- as.numeric(as.character(HSKP$Hotel_Invetory))
HSKP$Total_Rooms <- as.numeric(as.character(HSKP$Total_Rooms))
HSKP$Mediana <- as.numeric(as.character(HSKP$Mediana))
HSKP$Fixed_Occ. <- as.numeric(as.character(HSKP$Fixed_Occ.))
HSKP$Conf_of_Occ._per_Category <- as.numeric(as.character(HSKP$Conf_of_Occ._per_Category))
names(HSKP)[10]<-'SQM'
names(HSKP)[1]<-'Hotel'
HSKP$Rooms_Sold <- round(HSKP[,6]*HSKP[,7]*HSKP[,5]*HSKP[,8],)
HSKP$Rooms_Avaliable <- HSKP[,5]*HSKP[,7]
HSKP$Category_Occ <- HSKP[,11]/HSKP[,12]
HSKP$Sum_SQM <- HSKP[,11]*HSKP[,10]
HSKP$SQM_per_day <- HSKP[,14]/HSKP[,5]
setwd ("C:/Users/E-MaxPCShop/Desktop/R_Project/Calc_HSKP_Project")
Hotel_Revenue <-read.csv2("Hotels_Revenue.csv",sep=";")
Rooms_SQM2 <-read.csv2("Rooms_sq.m..csv",sep=";",)
HSKP <- merge(Hotel_Revenue,Rooms_SQM2,by.x = c('ï..Hotel','Category'),by.y = c('ï..Hotel','Category'))
HSKP$Days_in_Month <- as.numeric(as.character(HSKP$Days_in_Month))
HSKP$Hotel_Invetory <- as.numeric(as.character(HSKP$Hotel_Invetory))
HSKP$Total_Rooms <- as.numeric(as.character(HSKP$Total_Rooms))
HSKP$Mediana <- as.numeric(as.character(HSKP$Mediana))
HSKP$Fixed_Occ. <- as.numeric(as.character(HSKP$Fixed_Occ.))
HSKP$Conf_of_Occ._per_Category <- as.numeric(as.character(HSKP$Conf_of_Occ._per_Category))
names(HSKP)[10]<-'SQM'
names(HSKP)[1]<-'Hotel'
HSKP$Rooms_Sold <- round(HSKP$Days_in_Month*HSKP$Conf_of_Occ._per_Category*HSKP$Hotel_Invetory*HSKP$Fixed_Occ.,)
HSKP$Rooms_Avaliable <- HSKP[,5]*HSKP[,7]
HSKP$Category_Occ <- HSKP[,11]/HSKP[,12]
HSKP$Sum_SQM <- HSKP[,11]*HSKP[,10]
HSKP$SQM_per_day <- HSKP[,14]/HSKP[,5]
View(HSKP)
View(HSKP)
